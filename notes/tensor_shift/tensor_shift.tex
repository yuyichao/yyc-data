\documentclass[10pt,fleqn]{article}
% \usepackage[journal=rsc]{chemstyle}
% \usepackage{mhchem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{esint}
\usepackage{bbm}
\usepackage{amscd}
\usepackage{picinpar}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{indentfirst}
\usepackage{wrapfig}
\usepackage{units}
\usepackage{textcomp}
\usepackage[utf8x]{inputenc}
% \usepackage{feyn}
% \usepackage{feynmp}
\usepackage{xkeyval}
\usepackage{xargs}
\usepackage{verbatim}
\usepackage{pgfplots}
\usepackage{hyperref}
\usetikzlibrary{
  arrows,
  calc,
  decorations.pathmorphing,
  decorations.pathreplacing,
  decorations.markings,
  fadings,
  positioning,
  shapes
}

\DeclareGraphicsRule{*}{mps}{*}{}
\newcommand{\ud}{\mathrm{d}}
\newcommand{\ue}{\mathrm{e}}
\newcommand{\ui}{\mathrm{i}}
\newcommand{\res}{\mathrm{Res}}
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\dlim}{\displaystyle\lim}
\newcommand{\dint}{\displaystyle\int}
\newcommand{\fsno}[1]{{\!\not\!{#1}}}
\newcommand{\eqar}[1]
{
  \begin{align}
    #1
  \end{align}
}
\newcommand{\texp}[2]{\ensuremath{{#1}\times10^{#2}}}
\newcommand{\dexp}[2]{\ensuremath{{#1}\cdot10^{#2}}}
\newcommand{\eval}[2]{{\left.{#1}\right|_{#2}}}
\newcommand{\paren}[1]{{\left({#1}\right)}}
\newcommand{\lparen}[1]{{\left({#1}\right.}}
\newcommand{\rparen}[1]{{\left.{#1}\right)}}
\newcommand{\abs}[1]{{\left|{#1}\right|}}
\newcommand{\sqr}[1]{{\left[{#1}\right]}}
\newcommand{\crly}[1]{{\left\{{#1}\right\}}}
\newcommand{\angl}[1]{{\left\langle{#1}\right\rangle}}
\newcommand{\tpdiff}[4][{}]{{\paren{\frac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}}_{#4}}}
\newcommand{\tpsdiff}[4][{}]{{\paren{\frac{\partial^{#1}}{\partial {#3}{}^{#1}}{#2}}_{#4}}}
\newcommand{\pdiff}[3][{}]{{\frac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}}}
\newcommand{\diff}[3][{}]{{\frac{\ud^{#1} {#2}}{\ud {#3}{}^{#1}}}}
\newcommand{\psdiff}[3][{}]{{\frac{\partial^{#1}}{\partial {#3}{}^{#1}} {#2}}}
\newcommand{\sdiff}[3][{}]{{\frac{\ud^{#1}}{\ud {#3}{}^{#1}} {#2}}}
\newcommand{\tpddiff}[4][{}]{{\left(\dfrac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}\right)_{#4}}}
\newcommand{\tpsddiff}[4][{}]{{\paren{\dfrac{\partial^{#1}}{\partial {#3}{}^{#1}}{#2}}_{#4}}}
\newcommand{\pddiff}[3][{}]{{\dfrac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}}}
\newcommand{\ddiff}[3][{}]{{\dfrac{\ud^{#1} {#2}}{\ud {#3}{}^{#1}}}}
\newcommand{\psddiff}[3][{}]{{\frac{\partial^{#1}}{\partial{}^{#1} {#3}} {#2}}}
\newcommand{\sddiff}[3][{}]{{\frac{\ud^{#1}}{\ud {#3}{}^{#1}} {#2}}}
\usepackage{fancyhdr}
\usepackage{multirow}
\usepackage{fontenc}
% \usepackage{tipa}
\usepackage{ulem}
\usepackage{color}
\usepackage{cancel}
\newcommand{\hcancel}[2][black]{\setbox0=\hbox{#2}%
  \rlap{\raisebox{.45\ht0}{\textcolor{#1}{\rule{\wd0}{1pt}}}}#2}
\pagestyle{fancy}
\setlength{\headheight}{67pt}
\fancyhead{}
\fancyfoot{}
\fancyfoot[C]{\thepage}
\fancyhead[R]{}
\renewcommand{\footruleskip}{0pt}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

\newcommand\pgfmathsinandcos[3]{%
  \pgfmathsetmacro#1{sin(#3)}%
  \pgfmathsetmacro#2{cos(#3)}%
}
\newcommand\LongitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % azimuth
  \tikzset{#1/.estyle={cm={\cost,\sint*\sinEl,0,\cosEl,(0,0)}}}
}
\newcommand\LatitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % latitude
  \pgfmathsetmacro\yshift{\cosEl*\sint}
  \tikzset{#1/.estyle={cm={\cost,0,0,\cost*\sinEl,(0,\yshift)}}} %
}
\newcommand\DrawLongitudeCircle[2][1]{
  \LongitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{atan(sin(#2)*cos(\angEl)/sin(\angEl))} %
  \draw[current plane] (\angVis:1) arc (\angVis:\angVis+180:1);
  \draw[current plane,dashed] (\angVis-180:1) arc (\angVis-180:\angVis:1);
}
\newcommand\DrawLatitudeCircleArrow[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[current plane,decoration={markings, mark=at position 0.6 with {\arrow{<}}},postaction={decorate},line width=.6mm] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed,line width=.6mm] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}
\newcommand\DrawLatitudeCircle[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[current plane] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}
\newcommand\coil[1]{
  {\rh * cos(\t * pi r)}, {\apart * (2 * #1 + \t) + \rv * sin(\t * pi r)}
}
\makeatletter
\define@key{DrawFromCenter}{style}[{->}]{
  \tikzset{DrawFromCenterPlane/.style={#1}}
}
\define@key{DrawFromCenter}{r}[1]{
  \def\@R{#1}
}
\define@key{DrawFromCenter}{center}[(0, 0)]{
  \def\@Center{#1}
}
\define@key{DrawFromCenter}{theta}[0]{
  \def\@Theta{#1}
}
\define@key{DrawFromCenter}{phi}[0]{
  \def\@Phi{#1}
}
\presetkeys{DrawFromCenter}{style, r, center, theta, phi}{}
\newcommand*\DrawFromCenter[1][]{
  \setkeys{DrawFromCenter}{#1}{
    \pgfmathsinandcos\sint\cost{\@Theta}
    \pgfmathsinandcos\sinp\cosp{\@Phi}
    \pgfmathsinandcos\sinA\cosA{\angEl}
    \pgfmathsetmacro\DX{\@R*\cost*\cosp}
    \pgfmathsetmacro\DY{\@R*(\cost*\sinp*\sinA+\sint*\cosA)}
    \draw[DrawFromCenterPlane] \@Center -- ++(\DX, \DY);
  }
}
\newcommand*\DrawFromCenterText[2][]{
  \setkeys{DrawFromCenter}{#1}{
    \pgfmathsinandcos\sint\cost{\@Theta}
    \pgfmathsinandcos\sinp\cosp{\@Phi}
    \pgfmathsinandcos\sinA\cosA{\angEl}
    \pgfmathsetmacro\DX{\@R*\cost*\cosp}
    \pgfmathsetmacro\DY{\@R*(\cost*\sinp*\sinA+\sint*\cosA)}
    \draw[DrawFromCenterPlane] \@Center -- ++(\DX, \DY) node {#2};
  }
}
\makeatother

\makeatletter
\renewcommand*\env@matrix[1][\arraystretch]{%
  \edef\arraystretch{#1}%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols c}}
\makeatother

\tikzstyle{snakearrow} = [decorate, decoration={pre length=0.2cm,
  post length=0.2cm, snake, amplitude=.4mm,
  segment length=2mm},thick, ->]
%% document-wide tikz options and styles
\tikzset{%
  >=latex, % option for nice arrows
  inner sep=0pt,%
  outer sep=2pt,%
  mark coordinate/.style={inner sep=0pt,outer sep=0pt,minimum size=3pt,
    fill=black,circle}%
}
\addtolength{\hoffset}{-1.3cm}
\addtolength{\voffset}{-2cm}
\addtolength{\textwidth}{3cm}
\addtolength{\textheight}{2.5cm}
\renewcommand{\footskip}{10pt}
\setlength{\headwidth}{\textwidth}
\setlength{\headsep}{20pt}
\setlength{\marginparwidth}{0pt}
\parindent=0pt
\title{Light shift and effective B field}

\ifpdf
  % Ensure reproducible output
  \pdfinfoomitdate=1
  \pdfsuppressptexinfo=-1
  \pdftrailerid{}
  \hypersetup{
    pdfcreator={},
    pdfproducer={}
  }
\fi

\allowdisplaybreaks

\begin{document}

\maketitle

\section{Goal}
Derive and clarify some effects related to vector and tensor light shifts
as well as a few different places they may appear in an experiment.
Most, if not all of the discussion will be limited to E1 transitions.
I'm not really looking for the most mathematically straight forward derivation,
rather trying to see this from different angle for better understanding.

\section[Summary of main results]{Summary of main results\protect\footnote{``Results'' as in ones that are hard to find elsewhere in a form that I like. I'm sure many people have derived/used these before. This does not include standard ones like Wigner-Eckart theorem since it's easy to find reference for it.}}

See the linked sections for the quantitative results.
\begin{enumerate}
\item Section~\ref{stark-shift-explicit} checks the Stark shift's dependency
  on $m_F$ by explicitly compute it using the Clebsch-Gordan coefficients.
  It confirms that {\color{blue}the dependency of the Stark shift on $m_F$
    is at most a second order polynomial} and it has the expected symmetry
  when driven with linear or circular polarized light.
\item Section~\ref{full-effective-explicit} proves that the second order coupling
  between to states $F$ and $F'$ is {\color{blue}proportional to
    the Clebsch-Gordan coefficients $\langle F',m_F'|F,k;m_F,p\rangle$}
  where $k=0,1,2$ denotes scalar, vector and tensor coupling.
\end{enumerate}

\section{Vector and tensor light shift}
In this section we'll discuss the result of second-order pertubation
on dipole transitions. This includes Raman transitions and Stark shifts.

\subsection{Generic expression}
The effective Hamiltonian from second-order pertubation,
\footnote{Here we've omitted the counter rotating term.
  Including such term will not change the qualitative result of this discussion,
  which only relies on the numerator of each pertubation terms.}
\eqar{
  H_{\mathrm{eff}}=&\sum_{e}\frac{\vec d\cdot\vec E|e\rangle\langle e|\vec d\cdot\vec E^*}{\Delta_e}\\
  =&\paren{\vec E\vec E^*}\cdot\sum_{e}\frac{\vec d|e\rangle\langle e|\vec d}{\Delta_e}
}
Since $H_{\mathrm{eff}}$ is a scalar operator for all possible values of $\vec E$,
the right half of the expression $\sum_{e}\dfrac{\vec d|e\rangle\langle e|\vec d}{\Delta_e}$ must be a rank-2 tensor operator.\\

Therefore, we can always decompose the Hamiltonian into the spherical tensor components
$H^k_q$, where $k=0,1,2$ corresponds to the scalar, vector and tensor parts.
The whole effective Hamiltonian can be written as,
\eqar{
  H_{\mathrm{eff}}=&\sum_{k,p}(-1)^p T^k_{-p}H^k_p
}
where $T^k_p=\dsum_{q,q'}E_q(E^*)_{q'}\langle 1,1;q,q'|k,p\rangle$.
The matrix element would be of the form,
\eqar{
  \begin{split}
    &\langle F,m_F|H_{\mathrm{eff}}|F',m_F'\rangle\\
    =&\sum_{k,p}(-1)^p T^k_{-p}\langle F,m_F|H^k_p|F',m_F'\rangle\\
    =&\sum_{k}\langle F||H^k||F'\rangle\sum_{p}(-1)^p T^k_{-p}
       \langle F',k;m_F',p|F,m_F\rangle\\
    =&\sum_{k}(-1)^{k}\sqrt{\frac{2F+1}{2F'+1}}\langle F||H^k||F'\rangle
       \sum_{p}T^k_{p}\langle k,F;p,m_F|F',m_F'\rangle\\
    =&\sum_{k}H(F,F',k)\sum_{p}T^k_{p}\langle k,F;p,m_F|F',m_F'\rangle
  \end{split}
}
where the $H(F,F',k)$ in the last expression is a generic scalar factor
that depends only on $F$, $F'$ and $k$ but not on $p$, $m_F$, or $m_F'$.

% TODO

\subsection{Direct derivation}
The coupling between state $|F,m_F\rangle$ and $|F',m_F'\rangle$
\eqar{
  \langle F,m_F|d_{-q}|F',m_F'\rangle=&\langle F||\mathbf{d}||F'\rangle\langle F,m_F|F',1;m_F',-q\rangle\\
  =&\langle F||\mathbf{d}||F'\rangle (-1)^{F'-1+m_F}\sqrt{2F+1}
  \begin{pmatrix}
    F'&1&F\\
    m_F'&-q&m_F
  \end{pmatrix}
}
where $F$ and $m_F$ ($F'$ and $m_F'$) are the total angular momentum and its projection
for the initial (final) state. $d$ is the dipole operator and $q$ is the label
for the spherical harmonic component ($-1$, $0$, or $1$).
$q=\pm1$ corresponds to the $\sigma^\pm$ polarization/transition
and $q=0$ corresponds to the $\pi$ polarization/transition.\\

\subsubsection{Diagonal terms (Stark shifts) only}\label{stark-shift-explicit}
We can first calculate the Stark shift for a pure
($\sigma^+$, $\pi$ or $\sigma^-$) polarization.
This is the case that contains no non-diagonal terms.
We should be able to use this to verify the $m_F$ dependency of the final effect.
(Scalar, vector and tensor shift should corresponds to $0$, $1$ and $2$ order terms
of $m_F$ respectively).\\

Since we only care about the $m_F$ dependency, we can ignore everything that's
$m_F$ independent.\\

The Stark shift,
\eqar{
  \begin{split}
    \Delta E\propto&\langle F,m_F|d_{-q}|F',m_F'\rangle
                     \langle F',m_F'|d_q|F,m_F\rangle\\
    \propto&\abs{\langle F,m_F|F',1;m_F',-q\rangle}^2\\
    \propto&(F+m_F)!(F-m_F)!(F'-m_F-q)!(F'+m_F+q)!\\
                   &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!q\!-\!k)!(F'\!-\!F\!+\!1\!-\!k)!(F\!-\!F'\!+\!q\!+\!k)!(F'\!-\!q\!-\!k\!-\!m_F)!(F\!-\!1\!+\!q\!+\!k\!+\!m_F)!}}^2
  \end{split}
}
The last proportionality relation uses the generic explicit expression for the
Clebsch-Gordan coefficients (ignoring $m_F$ independent factors).
The sum is over all the $k$'s where the factorials are non-negative.
We'll call the last expression $\Delta'(m_F,q)$ in the following part for simplicity.

For $q=-1$
\eqar{
  \begin{split}
    &\Delta'(m_F,-1)\\
    =&(F+m_F)!(F-m_F)!(F'-m_F+1)!(F'+m_F-1)!\\
    &\abs{\sum_{k}\frac{(-1)^k}{k!(2\!-\!k)!(F'\!-\!F\!+\!1\!-\!k)!(F\!-\!F'\!-\!1\!+\!k)!(F'\!+\!1\!-\!k\!-\!m_F)!(F\!-\!2\!+\!k\!+\!m_F)!}}^2
  \end{split}
}
Since we have $F'\!-\!F\!+\!1\!-\!k\geqslant0$ and $F\!-\!F'\!-\!1\!+\!k\geqslant0$, we have $k=F'-F+1$, (with the explicit condition to make sure $F'+m_F-1\geqslant0$)
\eqar{
  \begin{split}
    &\Delta'(m_F,-1)\\
    =&\begin{cases}
      \dfrac{(F+m_F)!(F'-m_F+1)!}{\paren{(F'-F+1)!(F-F'+1)!}^2(F-m_F)!(F'+m_F-1)!}&(m_F\geqslant1-F')\\
      0&(m_F<1-F')
    \end{cases}
  \end{split}
}
To simplify this further, we used the fact that $F'=F-1,F,F+1$
\eqar{
  \begin{split}
    \Delta'(m_F,-1)=&\begin{cases}
      \dfrac{(F+m_F)!(F-m_F)!}{4(F-m_F)!(F+m_F-2)!}&(m_F\geqslant2-F,F'=F-1)\\
      0&(m_F<2-F,F'=F-1)\\
      \dfrac{(F+m_F)!(F-m_F+1)!}{(F-m_F)!(F+m_F-1)!}&(m_F\geqslant1-F,F'=F)\\
      0&(m_F<1-F,F'=F)\\
      \dfrac{(F+m_F)!(F-m_F+2)!}{4(F-m_F)!(F+m_F)!}&(m_F\geqslant1-(F+1),F'=F+1)\\
      0&(m_F<1-(F+1),F'=F+1)
    \end{cases}
  \end{split}\\
  \begin{split}
    \Delta'(m_F,-1)=&\begin{cases}
      \dfrac{(F+m_F)(F+m_F-1)}{4}&(F'=F-1)\\
      (F+m_F)(F-m_F+1)&(F'=F)\\
      \dfrac{(F-m_F+2)(F-m_F+1)}{4}&(F'=F+1)
    \end{cases}
  \end{split}
}
The final simplification uses the fact that $m_F\leqslant F$
and that the expression produces the right value (i.e. $0$) even for out-of-bound $m_F$.

For $q=0$,
\eqar{
  \begin{split}
    &\Delta'(m_F,0)\\
    =&(F+m_F)!(F-m_F)!(F'-m_F)!(F'+m_F)!\\
    &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(F'\!-\!F\!+\!1\!-\!k)!(F\!-\!F'\!+\!k)!(F'\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
  \end{split}
}
Conditional on the value of $F'$
\eqar{
  \begin{split}
    &\Delta'(m_F,0)\\
    =&\begin{cases}
      \begin{aligned}
        &(F+m_F)!(F-m_F)!(F-1-m_F)!(F-1+m_F)!\\
        &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(-k)!(1\!+\!k)!(F\!-\!1\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
      \end{aligned}&(F'=F-1)\\
      \begin{aligned}
        &(F+m_F)!(F-m_F)!(F-m_F)!(F+m_F)!\\
        &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(1\!-\!k)!k!(F\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
      \end{aligned}&(F'=F)\\
      \begin{aligned}
        &(F+m_F)!(F-m_F)!(F'-m_F)!(F'+m_F)!\\
        &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(2\!-\!k)!(-1\!+\!k)!(F\!+\!1\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
      \end{aligned}&(F'=F+1)
    \end{cases}
  \end{split}
}
For the first and third case, $k$ can only be $0$ and $1$ respectively.
For the second case, $k$ can be either $0$ or $1$ and we need to sum over both.
\eqar{
  \Delta'(m_F,0)=&\begin{cases}
    \dfrac{(F+m_F)!(F-m_F)!(F-1-m_F)!(F-1+m_F)!}{\paren{(F\!-\!1\!-\!m_F)!(F\!-\!1\!+\!m_F)!}^2}&(F'=F-1)\\
    \begin{aligned}
      &(F+m_F)!(F-m_F)!(F-m_F)!(F+m_F)!\\
      &\paren{
        \frac{1}{(F\!-\!m_F)!(F\!-\!1\!+\!m_F)!}
        -\frac{1}{(F\!-\!1\!-\!m_F)!(F\!+\!m_F)!}
        }^2
    \end{aligned}&(F'=F)\\
    \dfrac{(F+m_F)!(F-m_F)!(F+1-m_F)!(F+1+m_F)!}{\paren{(F\!-\!m_F)!(F\!+\!m_F)!}^2}
                                                                                                &(F'=F+1)
  \end{cases}\\
  \Delta'(m_F,0)=&\begin{cases}
    F^2-m_F^2&(F'=F-1)\\
    4m_F^2&(F'=F)\\
    (F+1)^2-m_F^2&(F'=F+1)
  \end{cases}
}

For $q=1$,
\eqar{
  \begin{split}
    &\Delta'(m_F,1)\\
    =&(F+m_F)!(F-m_F)!(F'-m_F-1)!(F'+m_F+1)!\\
    &\abs{\sum_{k}\frac{(-1)^k}{k!(-k)!(F'-F+1-k)!(F-F'+1+k)!(F'-1-k-m_F)!(F+k+m_F)!}}^2
  \end{split}
}
which requires $k=0$,
\eqar{
  \begin{split}
    \Delta'(m_F,1)=&\frac{(F+m_F)!(F-m_F)!(F'-m_F-1)!(F'+m_F+1)!}
                     {\paren{(F'-F+1)!(F-F'+1)!(F'-1-m_F)!(F+m_F)!}^2}\\
    =&\frac{(F-m_F)!(F'+m_F+1)!}{\paren{(F'-F+1)!(F-F'+1)!}^2(F'-m_F-1)!(F+m_F)!}
  \end{split}
}
Here we omitted the check for $F'-m_F-1\geqslant0$ since the final expression
would not depend on it. Conditional on the $F'$ values
\eqar{
  \Delta'(m_F,1)=&\begin{cases}
    \dfrac{(F-m_F)!(F+m_F)!}{4(F-m_F-2)!(F+m_F)!}&(F'=F-1)\\
    \dfrac{(F-m_F)!(F+m_F+1)!}{(F-m_F-1)!(F+m_F)!}&(F'=F)\\
    \dfrac{(F-m_F)!(F+m_F+2)!}{4(F-m_F)!(F+m_F)!}&(F'=F+1)
  \end{cases}\\
  \Delta'(m_F,1)=&\begin{cases}
    \dfrac{(F-m_F)(F-m_F-1)}{4}&(F'=F-1)\\
    (F-m_F)(F+m_F+1)&(F'=F)\\
    \dfrac{(F+m_F+2)(F+m_F+1)}{4}&(F'=F+1)
  \end{cases}
}

We can see that the expressions for $\Delta'(m_F,q)$ are
all second order polynomials of $m_F$. We can also verify that
$\Delta'(-m_F,1)=\Delta'(m_F,-1)$ as required by symmetry.\\

We can also see that for circular polarization ($q=\pm1$) the resulting shift
always have a non-zero linear term. The slope of this term is $\dfrac{1-2F}{4}$, $-1$,
and $\dfrac{2F+3}{4}$ for $\sigma^+$ polarization ($q=1$)
and $F'=F-1,F,F+1$ respectively\footnote{For the $F'=F-1$ expression, $1-2F$ may be $0$ for $F=\dfrac{1}{2}$ but this cannot happen for $F'=F-1$.}.
On the other hand, the expressions for $\pi$ polarization never
have any linear $m_F$ term which is also consistent with symmetry.\\

It is somewhat interesting that the coefficient for the second order terms
are never zero, even for $F=0,\dfrac{1}{2}$ cases where tensor shift does not exist.
Of course since there are not enough ``sampling points'' on the polynomial
the $m_F^2$ term would just appear at most as a global energy shift in such cases.

\subsubsection{Full generic effective Hamiltonian for a single excited state}
\label{full-effective-explicit}
When the polarization of the light is not one of the pure polarizations,
the effect of the second order perturbation would contain off-diagonal terms in addition
to the diagonal ones. In such cases, we would need to calculate the full effective
Hamiltonian matrix instead of only the Stark shifts.\\

Let the amplitude of the light be $A_q$, where $q=-1,0,1$ corresponds to the $\sigma^-$, $\pi$ and $\sigma^+$ polarizations. The matrix element for the effective Hamiltonian is,

\eqar{
  \begin{split}
    &\langle F,m_F|H_{\mathrm{eff}}|F',m_F'\rangle\\
    =&\frac{1}{4\Delta}\sum_{m_F'',q,q'}\langle F,m_F|(-1)^qA_{q}d_{-q}|F'',m_F''\rangle(\langle F',m_F'|(-1)^{q'}A_{q'}d_{-q'}|F'',m_F''\rangle)^*\\
    =&\frac{1}{4\Delta}\sum_{m_F'',q,q'}(-1)^qA_{q}(-1)^{q'}A_{q'}^*\langle F,m_F|d_{-q}|F'',m_F''\rangle(\langle F',m_F'|d_{-q'}|F'',m_F''\rangle)^*\\
    =&\frac{1}{4\Delta}\sum_{m_F'',q,q'}(-1)^qA_{q}(A^*)_{-q'}\langle F,m_F|d_{-q}|F'',m_F''\rangle(\langle F',m_F'|d_{-q'}|F'',m_F''\rangle)^*
  \end{split}
}
where $(A^*)_{q}$ is the spherical component of the complex conjugate of $A$ (ref Eq.~\ref{eq:spherical:conj}). Using Wigner-Echart and the spherical decomposition of rank-2 tensor.

\eqar{
  \begin{split}
    &\langle F,m_F|H_{\mathrm{eff}}|F',m_F'\rangle\\
    =&\frac{\langle F||d||F''\rangle\langle F'||d||F''\rangle^*}{4\Delta}\!\!\sum_{m_F'',q,q'}\!\!(-1)^qA_{q}(A^*)_{-q'}\langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F',m_F'\rangle\\
    =&\frac{\langle F||d||F''\rangle\langle F'||d||F''\rangle^*}{4\Delta}
       \!\sum_{k,p}T_p^k\\
    &\sum_{m_F'',q,q'}\!\!(-1)^q\langle k,p|1,1;q,-q'\rangle
      \langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F',m_F'\rangle
  \end{split}
}
Rewriting in $3-j$ symbol,
\eqar{
  \begin{split}
    &\sum_{m_F'',q,q'}\!\!(-1)^q\langle k,p|1,1;q,-q'\rangle
      \langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F',m_F'\rangle\\
    =&(-1)^{2F''+p-m_F-m_F'}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}\\
    &\sum_{m_F'',q,q'}\!\!(-1)^q\begin{pmatrix}
      1&1&k\\
      q&-q'&-p
    \end{pmatrix}\begin{pmatrix}
      F''&1&F\\
      m_F''&-q&-m_F
    \end{pmatrix}\begin{pmatrix}
      F''&1&F'\\
      m_F''&-q'&-m_F'
    \end{pmatrix}\\
    =&(-1)^{2F''+p-m_F-m_F'}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}\\
    &\sum_{m_F'',q,q'}\!\!(-1)^q\begin{pmatrix}
      1&k&1\\
      q'&-p&-q
    \end{pmatrix}\begin{pmatrix}
      1&F&F''\\
      q&-m_F&-m_F''
    \end{pmatrix}\begin{pmatrix}
      F''&F'&1\\
      m_F''&m_F'&-q'
    \end{pmatrix}\\
    =&(-1)^{F''+m_F-p}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}\\
    &\sum_{m_F'',q,q'}\!\!(-1)^{1+1+F''-q-q'-m_F''}\begin{pmatrix}
      1&k&1\\
      q'&-p&-q
    \end{pmatrix}\begin{pmatrix}
      1&F&F''\\
      q&-m_F&-m_F''
    \end{pmatrix}\begin{pmatrix}
      F''&F'&1\\
      m_F''&m_F'&-q'
    \end{pmatrix}\\
    =&(-1)^{F''+m_F-p}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}
       \begin{pmatrix}
         k&F&F'\\
         p&m_F&-m_F'
       \end{pmatrix}\begin{Bmatrix}
         k&F&F'\\
         F''&1&1
       \end{Bmatrix}\\
    =&(-1)^{F''+F+k}\sqrt{\paren{2k+1}\paren{2F+1}}
       \langle k,F;p,m_F|F',m_F'\rangle\begin{Bmatrix}
         k&F&F'\\
         F''&1&1
       \end{Bmatrix}
  \end{split}
}

For $F'=F$,
\eqar{
  \begin{split}
    &\sum_{m_F'',q,q'}\!\!(-1)^q\langle k,p|1,1;q,-q'\rangle
      \langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F,m_F'\rangle\\
    =&(-1)^{F''+F+k}\sqrt{\paren{2k+1}\paren{2F+1}}
       \langle k,F;p,m_F|F,m_F'\rangle\begin{Bmatrix}
         k&F&F\\
         F''&1&1
       \end{Bmatrix}
  \end{split}
}

% Angular momentum summation/coupling.

\section{Vector light shift as effective magnetic field}

Electric field, $E_{x,y,z}$. Spherical components of electric field,
\eqar{
  E_0=&E_z\\
  E_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{E_x\pm\ui E_y}
}
Or the inverse conversion,
\eqar{
  E_x=&\frac{1}{\sqrt2}\paren{E_{-1}-E_{1}}\\
  E_y=&\frac{\ui}{\sqrt2}\paren{E_{1}+E_{-1}}\\
  E_z=&E_0
}
Complex conjugate of the electric field,
\eqar{
  (E^*)_0=&(E^*)_z\\
  (E^*)_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{(E^*)_x\pm\ui (E^*)_y}\\
  (E^*)_x=&\frac{1}{\sqrt2}\paren{(E^*)_{-1}-(E^*)_{1}}\\
  (E^*)_y=&\frac{\ui}{\sqrt2}\paren{(E^*)_{1}+(E^*)_{-1}}\\
  (E^*)_z=&(E^*)_0
}
Effective magnetic field
\eqar{
  \vec B=\alpha\vec E\times\vec E^*
}
where $\alpha$ is a scalar number.
\eqar{
  \begin{split}
    B_x=&\alpha\paren{E_y(E^*)_z-E_z(E^*)_y}\\
    =&\frac{\ui\alpha}{\sqrt2}\paren{\paren{E_{1}+E_{-1}}(E^*)_0-E_0\paren{(E^*)_{1}+(E^*)_{-1}}}
  \end{split}\\
  \begin{split}
    B_y=&\alpha\paren{E_z(E^*)_x-E_x(E^*)_z}\\
    =&\frac{\alpha}{\sqrt2}\paren{E_0\paren{(E^*)_{-1}-(E^*)_{1}}-\paren{E_{-1}-E_{1}}(E^*)_0}
  \end{split}\\
  \begin{split}
    B_z=&\alpha\paren{E_x(E^*)_y-E_y(E^*)_x}\\
    =&\frac{\ui\alpha}{2}\paren{\paren{E_{-1}-E_{1}}\paren{(E^*)_{1}+(E^*)_{-1}}-\paren{E_{1}+E_{-1}}\paren{(E^*)_{-1}-(E^*)_{1}}}\\
    =&\ui\alpha\paren{E_{-1}(E^*)_{1}-E_{1}(E^*)_{-1}}
  \end{split}
}
Spherical components for the effective magnetic field,
\eqar{
  \begin{split}
    B_{-1}=&\frac{1}{\sqrt2}\paren{B_x-\ui B_y}\\
    =&\ui\alpha\paren{E_{-1}(E^*)_0-E_0(E^*)_{-1}}
  \end{split}\\
  \begin{split}
    B_0=&B_z\\
    =&\ui\alpha\paren{E_{-1}(E^*)_{1}-E_{1}(E^*)_{-1}}
  \end{split}\\
  \begin{split}
    B_1=&-\frac{1}{\sqrt2}\paren{B_x+\ui B_y}\\
    =&\ui\alpha\paren{E_0(E^*)_{1}-E_{1}(E^*)_0}
  \end{split}
}
Note that the rank-1 component of the tensor $\vec E\vec E^*$ is
\eqar{
  T^1_p=&\sum_{q,q'}\langle 1,1;q,q'|1,p\rangle E_{q}(E^*)_{q'}
}
Or more explicitly,
\eqar{
  T^1_{-1}=&\frac{1}{\sqrt{2}}\paren{E_{0}(E^*)_{-1}-E_{-1}(E^*)_{0}}\\
  T^1_{0}=&\frac{1}{\sqrt{2}}\paren{E_{1}(E^*)_{-1}-E_{-1}(E^*)_{1}}\\
  T^1_{1}=&\frac{1}{\sqrt{2}}\paren{E_{1}(E^*)_{0}-E_{0}(E^*)_{1}}
}
so we have $B_q=-\ui\sqrt2\alpha T^1_{q}$.\\

The vector shift from the effective magnetic field is,
\eqar{
  \begin{split}
    &\langle F,m_F|\vec\mu\cdot\vec B|F,m_F'\rangle\\
    =&\langle F,m_F|\sum_{q}(-1)^q\mu_{-q}B_{q}|F,m_F'\rangle\\
    =&-\ui\sqrt2\alpha g\sum_{q}(-1)^qT^1_{q}\langle F,m_F|F_{-q}|F,m_F'\rangle\\
    =&-\ui\sqrt2\alpha g\sqrt{(F+1)F}\sum_{q}(-1)^qT^1_{q}\langle F,1;m_F',-q|F,m_F\rangle
  \end{split}
}

\section{Mitigating the effect of transverse circular polarization in optical tweezers}

% Use effective hamiltonian to explain Raman transitions.

\appendix

\section{Some useful formulas}

\subsection{Spherical components of vector}

Similar to the decomposition of light polarization into $\sigma^\pm$ and $\pi$,
every 3D vector (operator) can be equivalently expressed
as a rank-$1$ spherical tensor,
\eqar{
  \begin{split}
    V_0=&V_z\\
    V_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{V_x\pm\ui V_y}
  \end{split}
}

In particular, when applied to the angular momentum operator,
\eqar{
  \begin{split}
    J_0=&J_z\\
    J_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{J_x\pm\ui J_y}\\
    =&\mp\frac{J_{\pm}}{\sqrt2}
  \end{split}
}
where $J_{\pm}$ are the angular momentum raising and lowering operators.\\

For the complex conjugate of the vector $V^*$, defined as
\eqar{
  (V^*)_{x,y,z}=&V^*_{x,y,z}
}
The spherical components are
\eqar{
  \begin{split}
    (V^*)_0=&V^*_z\\
    (V^*)_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{V^*_x\pm\ui V^*_y}
  \end{split}\label{eq:spherical:conj}
}
Note that in general $(V^*)_{\pm1}\neq V^*_{\pm1}$. In fact,
\eqar{
  \begin{split}
    V^*_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{V^*_x\mp\ui V^*_y}\\
    =&-(V^*)_{\mp1}
  \end{split}\\
  \begin{split}
    V^*_q=&(-1)^q(V^*)_{-q}
  \end{split}
}
i.e. the $+1$ component of $V^*$ is related to the $-1$ component of $V$,
and the $-1$ component of $V^*$ is related to the $+1$ component of $V$.\\

Dot product of two vector
\eqar{
  \begin{split}
    \vec A\cdot\vec B=&\sum_{i=x,y,z}A_iB_i\\
    =&-A_{-1}B_{+1}-A_{+1}B_{-1}+A_0B_0\\
    =&\sum_{q=-1,0,1}(-1)^qA_{q}B_{-q}\\
    =&-\sqrt{3}\sum_{q=-1,0,1}\langle 0,0|1,1;q,-q\rangle A_{q}B_{-q}
  \end{split}
}

\subsection{Spherical components of rank-$2$ tensor}

\subsubsection{Semi-quantitative discussion}

A rank-$2$ tensor is a direct product of two vectors (or at least in the linear space).
So to understand how a rank-$2$ tensor is related to it's spherical components,
we can simply study the direct product of two vectors.\\

Based on the discussion of the spherical components of vectors above,
a rank-$2$ tensor (or the direct product of two vectors) would be
equivalent to the product of two rank-$1$ spherical tensors.
Based on group representation theory, or equivalently,
angular momentum summation rules, the rank-$2$ tensor can be written
as the direct sum of a rank-$0$, $1$ and $2$ spherical tensor.\\

Without detailed derivation, we can identify the form of the three components based on
the following rules,
\begin{enumerate}
\item Each element of the pherical tensors is a linear combination
  of the tensor elements.
\item Each one of the tensors (rank-$0$, $1$ and $2$) need to satisfy
  the correct transformation rules.
  In particular, the rank-$0$ component is a scalar
  and the rank-$1$ compoment should be equivalent to a vector.
\item Each element should be linearly independent.
\end{enumerate}
Based on these rules, up to a constant factor,
the rank-$0$ spherical tensor must be the dot product of the two vectors
and the rank-$1$ spherical tensor must be equivalent to the cross product
of the two vectors.\\

Although there isn't a direct analogy for the rank-$2$ spherical tensor part,
it must correspond to the remaining elements in the original
rank-$2$ (cartesian) tensor.
Since the dot product is the trace of the tensor and the cross product
is the anti-symmetric part of the tensor, the remaining part of the original tensor
is the zero-trace symmetric part of the tensor. This part has $5$ degrees of freedoms,
which agrees with the number of elements
in the rank-$2$ spherical tensor that we need.
Up to a constant factor, we can write out these elements for
a rank-$2$ cartesian tensor $T_{ij}$ as,\\

Rank-$0$ spherical / scalar,
\eqar{
  \begin{split}
    E=&\sum_{i}T_{ii}
  \end{split}\label{eq:scalar-compoments}
}
Rank-$1$ spherical / vector,
\eqar{
  \begin{split}
    A_i=&\sum_{jk}\varepsilon_{ijk}T_{jk}
  \end{split}\label{eq:vector-compoments}
}
where $\varepsilon_{ijk}$ is the Levi-Civita symbol.
Note that for tensor that's the direct product of two vectors,
this is just the cross product of the two vectors.\\

Rank-$2$ spherical / tensor,
\eqar{
  \begin{split}
    S_{ij}=&\frac12\paren{T_{ij}+T_{ji}}-\frac13\delta_{ij}\sum_{k}T_{kk}
  \end{split}\label{eq:symm-tensor-compoments}
}

\subsubsection{Exact tensor component}
The decomposition of the rank-$2$ tensor into a linear combination of spherical tensors
isn't unique, each spherical tensor can always be scaled by
an arbitrary non-zero factor. However, for convinience, we would like to pick one
that's consistent with how two rank-$1$ spherical tensors are multiplied together,
i.e.
\eqar{
  \begin{split}
    T^k_q=&\sum_{q_1,q_2}\langle k,q|1,1;q_1,q_2\rangle X^1_{q_1}Y^1_{q_2}
  \end{split}
}

First we take the direct product of two vectors $X$ and $Y$,
\eqar{
  \begin{split}
    T_{ij}=&X_iY_j
  \end{split}
}

For the rank-$0$ spherical component,
\eqar{
  \begin{split}
    T^0_0=&\sum_{q_1,q_2}\langle 0,0|1,1;q_1,q_2\rangle X^1_{q_1}Y^1_{q_2}\\
    =&\frac{1}{\sqrt3}\paren{X^1_{-1}Y^1_{1}-X^1_{0}Y^1_{0}+X^1_{1}Y^1_{-1}}\\
    =&-\frac{1}{\sqrt3}\sum_{ii}T_{ii}\\
    =&-\frac{\vec X\cdot\vec Y}{\sqrt3}
  \end{split}
}
Rank-$1$ spherical components,
\eqar{
  \begin{split}
    T^1_q=&\sum_{q_1,q_2}\langle 1,q|1,1;q_1,q_2\rangle X^1_{q_1}Y^1_{q_2}\\
    =&\begin{cases}
      \dfrac{X^1_{0}Y^1_{-1}-X^1_{-1}Y^1_{0}}{\sqrt2}&(q=-1)\\
      \dfrac{X^1_{1}Y^1_{-1}-X^1_{-1}Y^1_{1}}{\sqrt2}&(q=0)\\
      \dfrac{X^1_{1}Y^1_{0}-X^1_{0}Y^1_{1}}{\sqrt2}&(q=1)\\
    \end{cases}\\
    =&\begin{cases}
      \dfrac{\paren{T_{zx}-T_{xz}}+\ui\paren{T_{yz}-T_{zy}}}{2}&(q=-1)\\
      \dfrac{\ui}{\sqrt2}\paren{T_{xy}-T_{yx}}&(q=0)\\
      \dfrac{\paren{T_{zx}-T_{xz}}-\ui\paren{T_{yz}-T_{zy}}}{2}&(q=1)\\
    \end{cases}\\
    =&\dfrac{\ui}{\sqrt2}\begin{cases}
      \dfrac{\paren{\vec X\times\vec Y}_x-\ui\paren{\vec X\times\vec Y}_y}{\sqrt2}&(q=-1)\\
      \paren{\vec X\times\vec Y}_z&(q=0)\\
      -\dfrac{\paren{\vec X\times\vec Y}_x+\ui\paren{\vec X\times\vec Y}_y}{\sqrt2}&(q=1)\\
    \end{cases}\\
    =&\dfrac{\ui}{\sqrt2}\paren{\vec X\times\vec Y}^1_q\\
  \end{split}
}
where $\paren{\vec X\times\vec Y}^1_q$ represents the spherical tensor components
of the $\vec X\times\vec Y$ vector.\\

Rank-$2$ spherical components,
\eqar{
  \begin{split}
    T^2_q=&\sum_{q_1,q_2}\langle 2,q|1,1;q_1,q_2\rangle X^1_{q_1}Y^1_{q_2}\\
    =&\begin{cases}
      X^1_{-1}Y^1_{-1}&(q=-2)\\
      \dfrac{X^1_{0}Y^1_{-1}+X^1_{-1}Y^1_{0}}{\sqrt2}&(q=-1)\\
      \dfrac{X^1_{1}Y^1_{-1}+2X^1_0Y^1_0+X^1_{-1}Y^1_{1}}{\sqrt6}&(q=0)\\
      \dfrac{X^1_{1}Y^1_{0}+X^1_{0}Y^1_{1}}{\sqrt2}&(q=1)\\
      X^1_{1}Y^1_{1}&(q=2)\\
    \end{cases}\\
    =&\begin{cases}
      \dfrac{\paren{T_{xx}-T_{yy}}-\ui\paren{T_{xy}+T_{yx}}}{2}&(q=-2)\\
      \dfrac{\paren{T_{zx}+T_{xz}}-\ui\paren{T_{zy}+T_{yz}}}{2}&(q=-1)\\
      \dfrac{2T_{zz}-T_{xx}-T_{yy}}{\sqrt6}&(q=0)\\
      -\dfrac{\paren{T_{zx}+T_{xz}}+\ui\paren{T_{zy}+T_{yz}}}{2}&(q=1)\\
      \dfrac{\paren{T_{xx}-T_{yy}}+\ui\paren{T_{xy}+T_{yx}}}{2}&(q=2)\\
    \end{cases}\\
    =&\begin{cases}
      \dfrac{S_{xx}-S_{yy}}{2}-\ui S_{xy}&(q=-2)\\
      S_{zx}-\ui S_{yz}&(q=-1)\\
      \sqrt{\dfrac{3}{2}}S_{zz}&(q=0)\\
      -S_{zx}-\ui S_{yz}&(q=1)\\
      \dfrac{S_{xx}-S_{yy}}{2}+\ui S_{xy}&(q=2)\\
    \end{cases}
  \end{split}
}
where the zero-trace symmetric $S_{ij}$ is defined above~(Eq.~\ref{eq:symm-tensor-compoments}).\\

The inverse transformation,
\eqar{
  T_{xx}=&-\frac{1}{\sqrt{3}}T^0_0-\frac1{\sqrt6}T^2_0+\frac{T^2_{-2}+T^2_{2}}2\\
  T_{xy}=&-\frac{\ui}{\sqrt2}T^1_0+\frac\ui2\paren{T^2_{-2}-T^2_{2}}\\
  T_{xz}=&\frac{T^2_{-1}-T^2_{1}}2-\frac{T^1_{-1}+T^1_{1}}2\\
  T_{yx}=&\frac{\ui}{\sqrt2}T^1_0+\frac\ui2\paren{T^2_{-2}-T^2_{2}}\\
  T_{yy}=&-\frac{1}{\sqrt{3}}T^0_0-\frac1{\sqrt6}T^2_0-\frac12\paren{T^2_{-2}+T^2_{2}}\\
  T_{yz}=&\frac\ui2\paren{T^2_{-1}+T^2_{1}}-\frac{\ui}{2}\paren{T^1_{-1}-T^1_{1}}\\
  T_{zx}=&\frac{T^2_{-1}-T^2_{1}}2+\frac{T^1_{-1}+T^1_{1}}2\\
  T_{zy}=&\frac\ui2\paren{T^2_{-1}+T^2_{1}}+\frac{\ui}{2}\paren{T^1_{-1}-T^1_{1}}\\
  T_{zz}=&-\frac{1}{\sqrt{3}}T^0_0+\sqrt{\frac{2}{3}}T^2_0
}

\subsubsection{Inner product of tensors}
The expressions we'll derive will involve inner product of tensors
(since the final energy is a scalar). Here we'll figure out what's the expression
for inner product using the spherical harmonic components.
\eqar{
  \begin{split}
    \overline{\overline{T}}:\overline{\overline{U}}=&\sum_{ij}T_{ij}U_{ij}\\
    =&\begin{pmatrix}[1.5]
      \paren{-\frac{1}{\sqrt{3}}T^0_0-\frac1{\sqrt6}T^2_0+\frac{T^2_{-2}+T^2_{2}}2}
      \paren{-\frac{1}{\sqrt{3}}U^0_0-\frac1{\sqrt6}U^2_0+\frac{U^2_{-2}+U^2_{2}}2}\\
      +\paren{-\frac{\ui}{\sqrt2}T^1_0+\frac\ui2\paren{T^2_{-2}-T^2_{2}}}
      \paren{-\frac{\ui}{\sqrt2}U^1_0+\frac\ui2\paren{U^2_{-2}-U^2_{2}}}\\
      +\paren{\frac{T^2_{-1}-T^2_{1}}2-\frac{T^1_{-1}+T^1_{1}}2}
      \paren{\frac{U^2_{-1}-U^2_{1}}2-\frac{U^1_{-1}+U^1_{1}}2}\\
      +\paren{\frac{\ui}{\sqrt2}T^1_0+\frac\ui2\paren{T^2_{-2}-T^2_{2}}}
      \paren{\frac{\ui}{\sqrt2}U^1_0+\frac\ui2\paren{U^2_{-2}-U^2_{2}}}\\
      +\paren{-\frac{1}{\sqrt{3}}T^0_0-\frac1{\sqrt6}T^2_0-\frac12\paren{T^2_{-2}+T^2_{2}}}
      \paren{-\frac{1}{\sqrt{3}}U^0_0-\frac1{\sqrt6}U^2_0-\frac12\paren{U^2_{-2}+U^2_{2}}}\\
      +\paren{\frac\ui2\paren{T^2_{-1}+T^2_{1}}-\frac{\ui}{2}\paren{T^1_{-1}-T^1_{1}}}
      \paren{\frac\ui2\paren{U^2_{-1}+U^2_{1}}-\frac{\ui}{2}\paren{U^1_{-1}-U^1_{1}}}\\
      +\paren{\frac{T^2_{-1}-T^2_{1}}2+\frac{T^1_{-1}+T^1_{1}}2}
      \paren{\frac{U^2_{-1}-U^2_{1}}2+\frac{U^1_{-1}+U^1_{1}}2}\\
      +\paren{\frac\ui2\paren{T^2_{-1}+T^2_{1}}+\frac{\ui}{2}\paren{T^1_{-1}-T^1_{1}}}
      \paren{\frac\ui2\paren{U^2_{-1}+U^2_{1}}+\frac{\ui}{2}\paren{U^1_{-1}-U^1_{1}}}\\
      +\paren{-\frac{1}{\sqrt{3}}T^0_0+\sqrt{\frac{2}{3}}T^2_0}
      \paren{-\frac{1}{\sqrt{3}}U^0_0+\sqrt{\frac{2}{3}}U^2_0}
    \end{pmatrix}\\
    =&\begin{pmatrix}[1.5]
      T^0_0U^0_0+T^1_{-1}U^1_{1}-T^1_0U^1_0+T^1_{1}U^1_{-1}\\
      +T^2_{-2}U^2_{2}-T^2_{-1}U^2_{1}+T^2_0U^2_0-T^2_{1}U^2_{-1}+T^2_{2}U^2_{-2}
    \end{pmatrix}\\
    =&\sum_{k,q}(-1)^{k+q}T^k_qU^k_{-q}\\
    =&\sum_{k}\sqrt{2k+1}\sum_{q}\langle 0,0|k,k;q,-q\rangle T^k_qU^k_{-q}\\
  \end{split}
}
we can see that each rank of spherical tensor component is only multiplied with
that of the same rank and the result is also consistent with the

\subsubsection{Cartesian form}
For calculation/understanding/visualization, it is sometimes still useful to write
the inner product in the cartesian form after decomposing it to
scalar/vector/tensor components.\\

Using the scalar, vector and tensor components from above~(Eq.~\ref{eq:scalar-compoments},\ref{eq:vector-compoments},\ref{eq:symm-tensor-compoments}),
the corresponding dot products for the three components are,
\eqar{
  \begin{split}
    E^{T}E^{U}=&\sum_{ij}T_{ii}U_{jj}\\
    =&T_{xx}U_{xx}+T_{yy}U_{yy}+T_{zz}U_{zz}
       +T_{xx}U_{yy}+T_{xx}U_{zz}+T_{yy}U_{xx}+T_{yy}U_{zz}+T_{zz}U_{xx}+T_{zz}U_{yy}
  \end{split}\\
  \begin{split}
    \vec A^{T}\cdot\vec A^{U}=&\sum_{ijkmm}\varepsilon_{ijk}\varepsilon_{imm}T_{jk}U_{mn}\\
    =&\sum_{ijklm}\paren{\delta_{jm}\delta_{kn}-\delta_{jn}\delta_{km}}T_{jk}U_{mn}\\
    =&\sum_{jk}\paren{T_{jk}U_{jk}-T_{jk}U_{kj}}\\
    =&T_{xy}U_{xy}+T_{yx}U_{yx}+T_{yz}U_{yz}+T_{zy}U_{zy}+T_{xz}U_{xz}+T_{zx}U_{zx}\\&
    -T_{xy}U_{yx}-T_{yx}U_{xy}-T_{yz}U_{zy}-T_{zy}U_{yz}-T_{xz}U_{zx}-T_{zx}U_{xz}
  \end{split}\\
  \begin{split}
    \overline{\overline{S}}^{T}:\overline{\overline{S}}^{U}=&\sum_{ij}\paren{\frac12\paren{T_{ij}+T_{ji}}-\frac13\delta_{ij}\sum_{k}T_{kk}}
       \paren{\frac12\paren{U_{ij}+U_{ji}}-\frac13\delta_{ij}\sum_{k}U_{kk}}\\
    =&\frac23\paren{T_{xx}U_{xx}+T_{yy}U_{yy}+T_{zz}U_{zz}}\\&
    -\frac13\paren{T_{xx}U_{yy}+T_{xx}U_{zz}+T_{yy}U_{xx}+T_{yy}U_{zz}+T_{zz}U_{xx}+T_{zz}U_{yy}}\\&
    +\frac12\paren{T_{xy}U_{xy}+T_{yx}U_{yx}+T_{yz}U_{yz}+T_{zy}U_{zy}+T_{xz}U_{xz}+T_{zx}U_{zx}}\\&
    +\frac12\paren{T_{xy}U_{yx}+T_{yx}U_{xy}+T_{yz}U_{zy}+T_{zy}U_{yz}+T_{xz}U_{zx}+T_{zx}U_{xz}}
  \end{split}
}
Combining the three,
\eqar{
  \begin{split}
    \overline{\overline{T}}:\overline{\overline{U}}=&\frac13E^{T}E^{U}+\frac12\vec A^{T}\cdot\vec A^{U}+\overline{\overline{S}}^{T}:\overline{\overline{S}}^{U}
  \end{split}
}

\subsection{Wigner-Eckart theorem}
This describes the relation between matrix elements of a vector/tensor operator
in the angular momentum basis.
The matrix element for different angular momentum states are related to each other
with Clebsch-Gordan coefficients.
\eqar{
  \langle j,m|T_q^{(k)}|j',m' \rangle=&\langle j',k;m',q|j,m\rangle\langle j||T^{(k)}||j'\rangle
}
where $T_q^{(k)}$ is the $q$-th component of
the spherical tensor operator $T^{(k)}$ of rank $k$.
This is the result of rotation symmetry between all the matrix elements.\\

Equivalently, this also means that no matter what the tensor operator is,
it's matrix elements in this (between these) subspace
differs from that of a different tensor operator only by a constant factor.
(Note that this factor could depend on the $j$ and $j'$ (just not $m$ and $m'$)
and it can of course be $0$ as well), i.e.
\eqar{
  \langle j,m|{T_1}_q^{(k)}|j',m'\rangle\propto&\langle j,m|{T_2}_q^{(k)}|j',m'\rangle
}

\subsection{When $j=j'$}
A special case for the Wigner-Echart theorem is when $j=j'$.
In this case we can plug in the angular momentum operator $J$
(this would otherwise result in vanishing matrix elements if $j\neq j'$
since $J$ conserves, well, $j$).
\eqar{
  \begin{split}
    \langle j,m|J_q|j,m' \rangle=&\langle j,1;m',q|j,m\rangle\langle j||J||j\rangle\\
    \propto&\langle j,1;m',q|j,m\rangle
  \end{split}
}
This allow us to replace the CG coefficents with the angular momentum operator, i.e.,
\eqar{
  \label{eq:jj:prop1}
  \langle j,m|V_q|j,m'\rangle\propto&\langle j,m|J_q|j,m'\rangle
}
which could make some calculation/expression significantly simpler.\\

This relation basically states that within the subspace of a single $j$,
we can treat any vector operator as proportional to the angular momentum.
The proportionality factor can then be obtained from the dot product
with angular momentum, i.e. the projection of the vector onto angular momentum.

\subsubsection{$m=0$ selection rule}
The selection rule for $m=m'=0$ transition directly follows from this relation
since,
\eqar{
  \begin{split}
    \langle j,m|V_0|j,m\rangle\propto&\langle j,m|J_0|j,m\rangle\\
    =&\langle j,m|J_z|j,m\rangle\\
    =&m
  \end{split}
}
which is $0$ when $m=0$.

\subsubsection{Projection theorem}
We can use this to derive the projection theorem.
Explicitly writing down the proportionality factor in Eq. \ref{eq:jj:prop1}, we have,
\eqar{
  \langle j,m|V_q|j,m'\rangle=&c\langle j,m|J_q|j,m'\rangle
}
Multiply both sides with the angular momentum matrix element
and sum over all $m'$ and $q$
\eqar{
  \sum_{m',q}\langle j,m|V_q|j,m'\rangle\langle j,m'|J_q^\dagger|j,m''\rangle=&c\sum_{m',q}\langle j,m|J_q|j,m'\rangle\langle j,m'|J_q^\dagger|j,m''\rangle\\
  \sum_q\langle j,m|V_qV_q^\dagger|j,m''\rangle=&c\sum_q\langle j,m|J_qJ_q^\dagger|j,m''\rangle\\
  \begin{split}
    \langle j,m|(\vec V\cdot \vec J)|j,m''\rangle=&c\langle j,m|J^2|j,m''\rangle\\
    =&c j(j+1)
  \end{split}
}
Therefore we have
\eqar{
  c=&\frac{\langle j,m|(\vec V\cdot \vec J)|j,m''\rangle}{j(j+1)}\\
  \langle j,m|V_q|j,m'\rangle=&\frac{\langle j,m|(\vec V\cdot \vec J)|j,m''\rangle}{j(j+1)}\langle j,m|J_q|j,m'\rangle
}

\subsubsection{Explicit calculation}
Just for completeness, we can verify this relation between angular momentum
and CG coefficients explicitly.
This part can be ignored without affecting the understanding of the rest.

First the expression using angular momentum operators,
\eqar{
  \begin{split}
    \langle j,m|J_0|j,m'\rangle=&\langle j,m|m'|j,m'\rangle\\
    =&m'\delta_{mm'}
  \end{split}\\
  \begin{split}
    \langle j,m|J_{\pm1}|j,m'\rangle=&\mp\frac{1}{\sqrt2}\langle j,m|J_{\pm}|j,m'\rangle\\
    =&\mp\sqrt{\frac{(j\mp m')(j\pm m' + 1)}{2}}\langle j,m|j,m'\pm1\rangle\\
    =&\mp\sqrt{\frac{(j\mp m')(j\pm m' + 1)}{2}}\delta_{m,m'\pm1}
  \end{split}
}

Using the explicit formula for the CG coefficients,
\eqar{
  \begin{split}
    \langle j,1;m',q|j,m\rangle=&\delta_{m,m'+q}\sqrt{\frac{(2j+1)(j+j-1)!(j-j+1)!(j+1-j)!}{(j+1+j+1)!}}\\
                                &\sqrt{(j+m)!(j-m)!(j-m')!(j+m')!(1-q)!(1+q)!}\\
                                &\sum_k\frac{(-1)^k}{k!(j+1-j-k)!(j-m'-k)!(1+q-k)!(j-1+m+k)!(j-j-q+k)!}\\
    =&\delta_{m,m'+q}\frac{\sqrt{(j+m)!(j-m)!(j-m')!(j+m')!(1-q)!(1+q)!}}{2\sqrt{(j+1)j}}\\
                                &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1+q-k)!(j-1+m'+k)!(-q+k)!}
  \end{split}
}
For $q=0$
\eqar{
  \begin{split}
    \langle j,1;m',0|j,m\rangle=&\delta_{mm'}
                                  \frac{\sqrt{(j+m)!(j-m)!(j-m)!(j+m)!}}{2\sqrt{(j+1)j}}\\
                                &\sum_{k=0,1}\frac{(-1)^k}{k!(1-k)!(j-m-k)!(1-k)!(j-1+m+k)!k!}\\
    =&\delta_{mm'}\frac{(j-m)!(j+m)!}{2\sqrt{(j+1)j}}
       \paren{\frac{1}{(j-m)!(j-1+m)!}-\frac{1}{(j-m-1)!(j+m)!}}\\
    =&m\frac{\delta_{mm'}}{\sqrt{j(j+1)}}
  \end{split}
}
For $q=\pm1$
\eqar{
  \begin{split}
    \langle j,1;m',\pm1|j,m\rangle=&\delta_{m,m'\pm1}\frac{\sqrt{(j+m)!(j-m)!(j-m')!(j+m')!(1\mp1)!(1\pm1)!}}{2\sqrt{(j+1)j}}\\
                                   &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1\pm1-k)!(j-1+m+k)!(\mp1+k)!}\\
    =&\frac{\delta_{m,m'\pm1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'\pm1)!(j-m'\mp1)!(j-m')!(j+m')!}{2}}\\
                                   &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1\pm1-k)!(j-1+m'+k)!(\mp1+k)!}
  \end{split}
}
For $q=1$
\eqar{
  \begin{split}
    \langle j,1;m',1|j,m\rangle=&\frac{\delta_{m,m'+1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'+1)!(j-m'-1)!(j-m')!(j+m')!}{2}}\\
                                &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1+1-k)!(j-1+m'+k)!(-1+k)!}\\
    =&-\frac{\delta_{m,m'+1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'+1)!(j-m'-1)!(j-m')!(j+m')!}{2(j-m'-1)!(j-m'-1)!(j+m')!(j+m')!}}\\
    =&-\sqrt{\frac{(j+m'+1)(j-m')}{2}}\frac{\delta_{m,m'+1}}{\sqrt{(j+1)j}}\\
  \end{split}
}
For $q=-1$
\eqar{
  \begin{split}
    \langle j,1;m',-1|j,m\rangle=&\frac{\delta_{m,m'-1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'-1)!(j-m'+1)!(j-m')!(j+m')!}{2}}\\
                                 &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(-k)!(j-1+m'+k)!(1+k)!}\\
    =&\frac{\delta_{m,m'-1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'-1)!(j-m'+1)!(j-m')!(j+m')!}{2(j-m')!(j-m')!(j+m'-1)!(j+m'-1)!}}\\
    =&\sqrt{\frac{(j-m'+1)(j+m')}{2}}\frac{\delta_{m,m'-1}}{\sqrt{(j+1)j}}
  \end{split}
}
Comparing the result from the two methods,
we can see that the proportionality factor is $\sqrt{(j+1)j}$, or
\eqar{
  \langle j,m|J_q|j,m'\rangle=&\sqrt{(j+1)j}\langle j,1;m',q|j,m\rangle\label{eq:projection:spin1}
}

\subsubsection{Generalizing the projection theorem to rank-2 tensor}
Following the same procesure for projection theorem,
we can also replace the spherical tensor operators with any
other spherical tensor operator of the same rank. For rank-2 tensor operators
on states with the same angular momentum,
we can use the the one constructed from the direct product of
two angular momentum operators: $(JJ)^2_p=\dsum_{q,q'}\langle 1,1;q,q'|2,p\rangle J_q J_{q'}$.\\

Inserting an identity and using equation~\ref{eq:projection:spin1},
\eqar{
  \begin{split}
    &\langle j,m|(JJ)^2_p|j,m'\rangle\\
    =&\sum_{q,q',m''}\langle 1,1;q,q'|2,p\rangle \langle j,m|J_q|j,m''\rangle\langle j,m''|J_{q'}|j,m'\rangle\\
    =&j(j+1)\sum_{q,q',m''}\langle 1,1;q,q'|2,p\rangle
       \langle j,1;m'',q|j,m\rangle
       \langle j,1;m',q'|j,m''\rangle\\
    =&\sqrt{5}j(j+1)(2j+1)\sum_{q,q',m''}(-1)^{-2j-m-m''-p}\\
                                  &\begin{pmatrix}
                                    1&2&1\\
                                    q'&-p&-q
                                  \end{pmatrix}
                                    \begin{pmatrix}
                                      1&j&j\\
                                      q&m&-m''
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                      j&j&1\\
                                      m''&-m'&-q'
                                    \end{pmatrix}\\
    =&\sqrt{5}j(j+1)(2j+1)(-1)^{j-m}\sum_{q,q',m''}(-1)^{1+1+j-q'-q-m''}\\
                                  &\begin{pmatrix}
                                    1&2&1\\
                                    q'&-p&-q
                                  \end{pmatrix}
                                    \begin{pmatrix}
                                      1&j&j\\
                                      q&m&-m''
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                      j&j&1\\
                                      m''&-m'&-q'
                                    \end{pmatrix}\\
    =&\sqrt{5}j(j+1)(2j+1)(-1)^{j-m}
       \begin{pmatrix}
         j&2&j\\
         m'&p&-m
       \end{pmatrix}
       \begin{Bmatrix}
         2&j&j\\
         j&1&1
       \end{Bmatrix}\\
    =&\sqrt{5}j(j+1)\sqrt{2j+1}(-1)^{2j}
       \begin{Bmatrix}
         2&j&j\\
         j&1&1
       \end{Bmatrix}
       \langle j,2;m',p|j,m\rangle
  \end{split}
}
which is indeed consistent with the Wigner-Echart theorem
(the only $m$ or $p$-dependent term is the Clebsch-Gordan coefficient).

\end{document}


% TODO
% Vector expression for tensor light shift (express vector using magnetic field and express tensor using EE dot FF)
% Expressions for scalar/vector/tensor polarizability
